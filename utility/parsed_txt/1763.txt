Question: Virtual Server: How to Configure Static Routes on a Windows Server
Article Text: SUMMARY: There may be a circumstance that requires you to have multiple network adapters on your Virtual Machine (VM). Multiple adapters may be required for accessing resources on a private network, or for backing up your server with Bacula Enterprise. For the full instructions on installing and configuring Bacula Enterprise, see the instructions here. Static routes are required when multiple network adapters are configured, so that only one network gateway is allowed at a time.This article assumes you will be configuring a private network adapter on the ITS private network on a Windows Server. The steps may differ if you're configuring static routes for a non-ITS private network. PREREQUISITES You will need (provided by ITS Managed Services): Private IP address Private gateway IP address Private subnet mask An additional network interface (NIC) for the private network will also be added on the VM by Managed Services (MS) staff. You will need to manually input the IP addresses in the network configuration. Follow the screenshot in the example below. Make sure to leave the "Default gateway" BLANK. Use these DNS servers for the ITS private network: 192.168.10.115 192.168.10.116 NOTE: For non-ITS networks, the DNS servers will be different. Static routes will need to be configured on the private network interface. Open the Command Prompt and run as an admistrator and enter netstat -r to display the routing table (the window will need to be expanded to show the entire output). Take note of the Interface List in the output as you will need to note down the interface number. In this example, the interface number of the secondary private interface is "16" (outlined in red below). You should also double-check the MAC address to make sure it is correct. Run the following commands in the terminal to add the static routes. You will need to know your private gateway IP address as provided by MS staff. route add 10.0.0.0 mask 255.0.0.0 <gateway IP> -p IF <interface number> route add 172.16.0.0 mask 255.240.0.0 <gateway IP> -p IF <interface number> route add 192.168.0.0 mask 255.255.0.0 <gateway IP> -p IF <interface number> The screenshot example shows adding the three static routes to the private gateway IP address 172.17.36.1 to the secondary network interface, which Windows defined as 16. Enter netstat -r again in the command prompt to confirm the addition of the static routes. To test that the routes are properly configured, enter nslookup dr-dir12.pvt.hawaii.edu to see if the DNS servers will resolve the offsite backup server. If it resolves, the output below will be displayed.
