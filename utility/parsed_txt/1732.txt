Question: Virtual Server: How to Install and Configure Backups (Bacula) on a RHEL Server
Article Text: SUMMARY The Bacula Enterprise Edition (BEE) backup service is the optional daily backup service listed in the ITS VMware Hosted Solutions page. Backups are file level only. If you are a virtual server customer and have purchased the daily backup service, a BEE client will need to be configured on your server to communicate with the backup server. This article describes installing and configuring the BEE client on a Red Hat Enterprise Linux (RHEL) virtual server. PREREQUISITES You should already have the daily backup service purchased through ITS Managed Services. If you have not already done so, please contact ITS Managed Services at itscs@hawaii.edu to do so. You should already have a private network connection on your virtual server. For more information, please see Virtual Server: How to Connect Your ITS-Hosted RHEL 7 Virtual Server to an ITS Private Network. PROCEDURE Do the following to install a BEE client on your RHEL virtual server: Contact ITS Managed Services at itscs@hawaii.edu asking that the latest version of the BEE client .rpm packages be file dropped to you (via the UH Filedrop service). Once you have these files, upload them to your virtual server's /root directory. Log into your virtual server and switch user to the root user. Install the BEE client software: # cd /root # yum install -y ./bacula-enterprise-*.rpm NOTE: You may need to install the bacula-enterprise-lib-*.rpm file first before installing the bacula-enterprise-client-*.rpm file. Modify the /opt/bacula/etc/bacula-fd.conf file (installed when you install the BEE client) as outlined in the following example. In this example, "bac10" is used as the hostname, but for your server, it should be the short hostname of your virtual server. (a) Change this: Director { Name = bac10-dir Password = "< random_password_1 >" } To this (change the Name and use the randomly generated password, or create your own): Director { Name = bacula-dir Password = "<random-password>" } (b) Change this: Director { Name = bac10-mon Password = "a long random password" Monitor = yes } To this (comment out all lines by prefixing them with a "#"): #Director { # Name = bacula-dir-mon # Password = "a long random password" # Monitor = yes #} (c) Change this: FileDaemon { # this is me Name = bac10-fd FDport = 9102 # where we listen for the director WorkingDirectory = /opt/bacula/working Pid Directory = /opt/bacula/working Maximum Concurrent Jobs = 20 Plugin Directory = /opt/bacula/plugins } To this (remove "-fd" from shortname of the host. Change Maximum Concurrent Jobs to 20): FileDaemon { # this is me Name = bac10 FDport = 9102 # where we listen for the director WorkingDirectory = /opt/bacula/working Pid Directory = /opt/bacula/working Maximum Concurrent Jobs = 20 Plugin Directory = /opt/bacula/plugins } (d) Change this: Messages { Name = Standard director = bac10-dir = all, !skipped, !restored, !saved } To this (change director name): Messages { Name = Standard director = bacula-dir = all, !skipped, !restored, !saved } Enable automatic start of the BEE client upon server boot: RHEL 7 and 8: # systemctl enable bacula-fd Restart bacula-fd service: RHEL 7 and 8: # systemctl start bacula-fd Run the following command to allow port 9102 incoming for the backup traffic: firewall-cmd --permanent --zone=public --add-port=9102/tcp && firewall-cmd --reload. (Optional) If TCP Wrappers is configured in the OS, add a rule to allow incoming connections from the Bacula Director Server dr-dir12.pvt.hawaii.edu. E.g., modify the /etc/hosts.allow file to add the line "ALL: 172.24.100.11 dr-dir12.pvt.hawaii.edu"). (Optional) Delete the bacula-enterprise-* .rpm files from /root. Notify IT TI-Applications that you have completed installing the BEE client on your virtual server. Please let us know the name of your virtual server, which directories you want backed up, and an estimate of you much storage space you expect the backup to require. Do not include the Bacula password in this email. If it is emailed in clear text, you will be required to change the password. A staff member from Contract Services will respond to you and ask you to send the password you made note of in step 4b above via the UH Filedrop service. RELATED ARTICLES Data Center Services Virtual Hosting: How to Submit a Restore Request Virtual Server: File Level Backup Policy Virtual Server: How to install and configure backups (Bacula) on a Windows Server Virtual Server: How to Connect Your ITS-Hosted RHEL 6 Virtual Server to an ITS Private Network Virtual Server: How to Connect Your ITS-Hosted RHEL 7 Virtual Server to an ITS Private Network
